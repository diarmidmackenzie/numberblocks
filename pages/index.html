<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@5.0.0/dist/aframe-event-set-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/fernandojsg/aframe-teleport-controls@master/dist/aframe-teleport-controls.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/diarmidmackenzie/key-bindings@v0.3-alpha/key-bindings.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/diarmidmackenzie/instanced-mesh@v0.2-alpha/src/instanced-mesh.min.js"></script>
    <script src="https://mixedreality.mozilla.org/ammo.js/builds/ammo.wasm.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.js"></script>
    <script src="../lib/super-hands.js"></script>
    <script src="../src/numberblocks.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/diarmidmackenzie/6dof-object-control@v0.5-alpha/src/keyboard-hand-controls.min.js"></script>

  </script>

</head>
<body>
  <a-scene physics="driver: ammo; debug: true; debugDrawMode: 1;" renderer="colorManagement:true">

  <a-mixin id="touch"
           ammo-phase-shift
           ammo-body="type: kinematic; emitCollisionEvents: true; disableCollision: true"
           ammo-shape="fit: manual; type:sphere; sphereRadius: 0.02"
           super-hands="colliderEvent: collidestart;
                        colliderEventProperty: targetEl;
                        colliderEndEvent: collideend;
                        colliderEndEventProperty: targetEl">

  </a-mixin>
  <!--static-body="shape: sphere; sphereRadius:   0.02"-->


  <a-entity id="rig" movement-controls>
    <a-text value="Press Left Shift or Right Shift to choose a controller to operate via kays.\n
                   Use debug mode on the physics engine to see controller positions.
                   Press 1, 2 or 3 to x, y or z,
                   then -/= to move in that direction.\n
                   Press 7 then + to Grip (+ again to un-grip)\n
                   Also, use 4/5/6 to rotate controller around x/y/z axes."
                   position="-7 1 -5" color="grey"></a-text>
    <a-camera id="camera" position="0 1.6 0" look-controls>
      <a-text id="log-panel1" wrapCount=80 width="1" value="L Hand Keyboard Sim Data" position="-1 0 -1.5" color="grey"></a-text>
      <a-text id="log-panel2" wrapCount=80 width="1" value="R Hand Keyboard Data" position="0 0 -1.5" color="grey"></a-text>
    </a-camera>
    <!--<a-entity id="lhand" mixin="touch"
              hand-controls="hand: left">
    </a-entity>
    <a-entity id="rhand" mixin="touch"
              hand-controls="hand: right">
    </a-entity>-->

    <a-entity id="lhand" mixin="touch"
              hand-controls="hand: left"
              keyboard-hand-controls="logger:#log-panel1"
              key-bindings="bindings:ShiftLeft=enable,ShiftRight=disable"
              position="-0.3 1.1 -1">
    </a-entity>
    <a-entity id="rhand" mixin="touch"
              hand-controls="hand: right"
              keyboard-hand-controls="logger:#log-panel2"
              key-bindings="bindings:ShiftRight=enable,ShiftLeft=disable"
              position="0.3 1.1 -1">
    </a-entity>
</a-entity>

  <!--  <a-entity id="rig" movement-controls>
      <a-entity id="camera"
                camera position="0 1.6 0"
                look-controls>
      </a-entity>

      <a-entity id="lhand"
                position = "-0.2 1 -1"
                visible="true"
                mixin="touch"
                hand-controls="hand: left">
      </a-entity>
      <a-entity id="rhand"
                position = "0.2 1 -1"
                visible="true"
                mixin="touch"
                hand-controls="hand: right">
      </a-entity>
    </a-entity>-->

<!-- assets-->
    <a-asset-item id="face1"
        src="../assets/faces/face1.glb"
        response-type="arraybuffer" crossorigin="anonymous"></a-asset-item>
    <a-asset-item id="limb1"
        src="../assets/limbs/limb.glb"
        response-type="arraybuffer" crossorigin="anonymous"></a-asset-item>

        <a-mixin id="cube" geometry="primitive: box; width: 0.33; height: 0.33; depth: 0.33"
                 hoverable
                 grabbable="constraintComponentName: ammo-constraint;"
                 stretchable draggable
                 event-set__hoveron="_event: hover-start; material.opacity: 0.7; transparent: true"
                 event-set__hoveroff="_event: hover-end; material.opacity: 1; transparent: false"
                 ammo-body="type: dynamic" ammo-shape="type: box"
                 shadow></a-mixin>


<a-box id = "bench" ammo-body="type: static" ammo-shape="type: box" material = "color:#774411" height = "0.9" width = "2" depth = "1.5" position = "0 0.45 -1" ammo-body="type: static">
</a-box>

<!--<a-entity id = "test" ammo-body="type: dynamic" ammo-shape="type: box; fit:manual;halfExtents:0.05 0.05 0.05" material = "color:#dd1111" height = "0.1" width = "0.1" depth = "0.1" position = "0 3 -1">
  <a-box material = "color:#dd1111" height = "0.1" width = "0.1" depth = "0.1">
  </a-box>
</a-entity>-->

<a-entity id= "red-cube-back" class="cube" mixin="cube" position="0 0.265 1" material="color: red"></a-entity>
<a-entity id= "red-cube-front" class="cube" mixin="cube" position="0 0.265 0.5" material="color: red"></a-entity>
<a-entity id= "blue-cube-back" class="cube" mixin="cube" position="-1.5 0.265 -1" material="color: blue"></a-entity>
<a-entity id= "blue-cube-front" class="cube" mixin="cube" position="-1.5 0.265 -0.5" material="color: blue"></a-entity>
<a-entity id= "green-cube-back" class="cube" mixin="cube" position="1.5 0.265 -1" material="color: green"></a-entity>
<a-entity id= "green-cube-front" class="cube" mixin="cube" position="1.5 0.265 -0.5" material="color: green"></a-entity>


<a-entity id = "oneEntity"
          ammo-body="type: dynamic"
          ammo-shape="type: box; fit:manual;halfExtents:0.05 0.0825 0.05"
          keyframe-animation
          position = "0 1.01575 -1"
          rotation = "0 0 0"
          numberblock="debug:true"
          grabbable="constraintComponentName: ammo-constraint">
  <a-entity id = "oneBody" keyframe-animation>
  <a-box id = "oneBox" material = "color:#dd1111" height = "0.1" width = "0.1" depth = "0.1" keyframe-animation position="0 0.0375 0">

    <a-entity gltf-model="#face1"
              keyframe-animation
              scale="0.05 0.05 0.05"
              position="0 0 0.05">
    </a-entity>
  </a-box>

  <a-entity id = "oneLArm" gltf-model="#limb1"
            scale="0.05 0.05 0.05"
            keyframe-animation
            position="0.05 0.0375 0"
            rotation="0 0 30">
  </a-entity>
  <a-entity id = "oneRArm" gltf-model="#limb1"
            keyframe-animation
            scale="0.05 0.05 0.05"
            position="-0.05 0.0375 0"
            rotation="0 0 -30">
  </a-entity>
  <a-entity id = "oneLLeg" gltf-model="#limb1"
            keyframe-animation
            scale="0.05 0.05 0.05"
            position="0.02 -0.0075 0"
            rotation="0 0 0">
  </a-entity>
  <a-entity id = "oneRLeg" gltf-model="#limb1"
            keyframe-animation
            scale="0.05 0.05 0.05"
            position="-0.02 -0.0075 0"
            rotation="0 0 0">
  </a-entity>

</a-entity>

</a-entity>

<!-- Floor-->
<a-entity id="floor-mesh1"
       bevelled-tile="facecolor: #020202; framecolor: black; width: 1; depth:1; frame: 0.015"
       instanced-mesh="capacity:400" tetrisland-floor
       position = "0 0 0"></a-entity>

<a-box id="floor-plane"
       width = "12" height = "0.001" depth = "12"
       ammo-body="type: static" ammo-shape="type: box"
       position = "0 0 0"
       visible = false>
</a-box>

</a-scene>

</body>
